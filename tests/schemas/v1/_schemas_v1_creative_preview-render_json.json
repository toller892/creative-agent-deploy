{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "/schemas/v1/creative/preview-render.json",
  "title": "Preview Render",
  "description": "A single rendered piece of a creative preview with discriminated output format",
  "oneOf": [
    {
      "type": "object",
      "description": "URL-only preview format",
      "properties": {
        "render_id": {
          "type": "string",
          "description": "Unique identifier for this rendered piece within the variant"
        },
        "output_format": {
          "const": "url",
          "description": "Discriminator indicating preview_url is provided"
        },
        "preview_url": {
          "type": "string",
          "format": "uri",
          "description": "URL to an HTML page that renders this piece. Can be embedded in an iframe."
        },
        "role": {
          "type": "string",
          "description": "Semantic role of this rendered piece. Use 'primary' for main content, 'companion' for associated banners, descriptive strings for device variants or custom roles."
        },
        "dimensions": {
          "type": "object",
          "description": "Dimensions for this rendered piece",
          "properties": {
            "width": {
              "type": "number",
              "minimum": 0
            },
            "height": {
              "type": "number",
              "minimum": 0
            }
          },
          "required": [
            "width",
            "height"
          ]
        },
        "embedding": {
          "type": "object",
          "description": "Optional security and embedding metadata for safe iframe integration",
          "properties": {
            "recommended_sandbox": {
              "type": "string",
              "description": "Recommended iframe sandbox attribute value (e.g., 'allow-scripts allow-same-origin')"
            },
            "requires_https": {
              "type": "boolean",
              "description": "Whether this output requires HTTPS for secure embedding"
            },
            "supports_fullscreen": {
              "type": "boolean",
              "description": "Whether this output supports fullscreen mode"
            },
            "csp_policy": {
              "type": "string",
              "description": "Content Security Policy requirements for embedding"
            }
          }
        }
      },
      "required": [
        "render_id",
        "output_format",
        "preview_url",
        "role"
      ],
      "additionalProperties": false
    },
    {
      "type": "object",
      "description": "HTML-only preview format",
      "properties": {
        "render_id": {
          "type": "string",
          "description": "Unique identifier for this rendered piece within the variant"
        },
        "output_format": {
          "const": "html",
          "description": "Discriminator indicating preview_html is provided"
        },
        "preview_html": {
          "type": "string",
          "description": "Raw HTML for this rendered piece. Can be embedded directly in the page without iframe. Security warning: Only use with trusted creative agents as this bypasses iframe sandboxing."
        },
        "role": {
          "type": "string",
          "description": "Semantic role of this rendered piece. Use 'primary' for main content, 'companion' for associated banners, descriptive strings for device variants or custom roles."
        },
        "dimensions": {
          "type": "object",
          "description": "Dimensions for this rendered piece",
          "properties": {
            "width": {
              "type": "number",
              "minimum": 0
            },
            "height": {
              "type": "number",
              "minimum": 0
            }
          },
          "required": [
            "width",
            "height"
          ]
        },
        "embedding": {
          "type": "object",
          "description": "Optional security and embedding metadata",
          "properties": {
            "recommended_sandbox": {
              "type": "string",
              "description": "Recommended iframe sandbox attribute value (e.g., 'allow-scripts allow-same-origin')"
            },
            "requires_https": {
              "type": "boolean",
              "description": "Whether this output requires HTTPS for secure embedding"
            },
            "supports_fullscreen": {
              "type": "boolean",
              "description": "Whether this output supports fullscreen mode"
            },
            "csp_policy": {
              "type": "string",
              "description": "Content Security Policy requirements for embedding"
            }
          }
        }
      },
      "required": [
        "render_id",
        "output_format",
        "preview_html",
        "role"
      ],
      "additionalProperties": false
    },
    {
      "type": "object",
      "description": "Both URL and HTML preview format",
      "properties": {
        "render_id": {
          "type": "string",
          "description": "Unique identifier for this rendered piece within the variant"
        },
        "output_format": {
          "const": "both",
          "description": "Discriminator indicating both preview_url and preview_html are provided"
        },
        "preview_url": {
          "type": "string",
          "format": "uri",
          "description": "URL to an HTML page that renders this piece. Can be embedded in an iframe."
        },
        "preview_html": {
          "type": "string",
          "description": "Raw HTML for this rendered piece. Can be embedded directly in the page without iframe. Security warning: Only use with trusted creative agents as this bypasses iframe sandboxing."
        },
        "role": {
          "type": "string",
          "description": "Semantic role of this rendered piece. Use 'primary' for main content, 'companion' for associated banners, descriptive strings for device variants or custom roles."
        },
        "dimensions": {
          "type": "object",
          "description": "Dimensions for this rendered piece",
          "properties": {
            "width": {
              "type": "number",
              "minimum": 0
            },
            "height": {
              "type": "number",
              "minimum": 0
            }
          },
          "required": [
            "width",
            "height"
          ]
        },
        "embedding": {
          "type": "object",
          "description": "Optional security and embedding metadata for safe iframe integration",
          "properties": {
            "recommended_sandbox": {
              "type": "string",
              "description": "Recommended iframe sandbox attribute value (e.g., 'allow-scripts allow-same-origin')"
            },
            "requires_https": {
              "type": "boolean",
              "description": "Whether this output requires HTTPS for secure embedding"
            },
            "supports_fullscreen": {
              "type": "boolean",
              "description": "Whether this output supports fullscreen mode"
            },
            "csp_policy": {
              "type": "string",
              "description": "Content Security Policy requirements for embedding"
            }
          }
        }
      },
      "required": [
        "render_id",
        "output_format",
        "preview_url",
        "preview_html",
        "role"
      ],
      "additionalProperties": false
    }
  ]
}
